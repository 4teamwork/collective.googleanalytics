<tal:tracking condition="view/available">
  <tal:web_property
      define="web_property view/getTrackingWebProperty;"
      condition="web_property">

    <script async src='https://www.googletagmanager.com/gtag/js?id=UA-XXXXXX-1'
      tal:attributes="src string:https://www.googletagmanager.com/gtag/js?id=${web_property}">
    </script>
    <script tal:content="string:
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', '${web_property}');">
    </script>"

    <tal:block content="structure view/renderPlugins"></tal:block>
    <script type="text/javascript" tal:content="structure view/renderPageview">
    </script>
  </tal:web_property>
</tal:tracking>
